[phases.setup]
nixPkgs = ["python311", "python311Packages.pip", "python311Packages.setuptools", "python311Packages.wheel", "nodejs-18_x"]

[phases.install]
cmds = [
    "npm install --prefix frontend",
    "curl -sS https://bootstrap.pypa.io/get-pip.py | python3 || python3 -m ensurepip --upgrade || true",
    "pip3 install --upgrade pip setuptools wheel",
    "pip3 install -r backend/requirements.txt"
]

[phases.build]
cmds = [
    "npm run build --prefix frontend",
    "cd backend && playwright install chromium"
]

[start]
cmd = "sh start.sh"
